
<!DOCTYPE html>
<html>
    <!-- 
    Password creator. Uses a web site name and a pass phrase.
    Created by Jacob Kanev, 2017.

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    For a copy of the GNU General Public License see <http://www.gnu.org/licenses/>.
    -->
    
    <head>
        <title>Password Manager</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        
        <style>
            
            html, body {
                background-color: #eef;
                width: 100vw;
                height: 100vh;
                margin: 0;
                padding: 0;
                border: 0;
                font-family: Sans-Serif;
                overflow: hidden;
            }
            
            button {
                position: relative;
                float: left;
                margin: 1vw;
                width: 13vw;
                border: 1px solid #CCCCCC;
                -webkit-box-shadow: #FEFFFF 0px 2px 2px ;
                -moz-box-shadow: #FEFFFF 0px 2px 2px ;
                box-shadow: #FEFFFF 0px 2px 2px ;
                -webkit-border-radius: 10px;
                -moz-border-radius: 10px;
                border-radius: 10px;
                padding: 10px 10px 10px 10px;
                text-shadow: 0px 2px 2px rgba(255,255,255,1);
                color: #4A4A4A;
                background-color: #F7F5F6;
                background-image: -webkit-gradient(linear, left top, left bottom, from(#F7F5F6), to(#DDDDDD));
                background-image: -webkit-linear-gradient(top, #F7F5F6, #DDDDDD);
                background-image: -moz-linear-gradient(top, #F7F5F6, #DDDDDD);
                background-image: -ms-linear-gradient(top, #F7F5F6, #DDDDDD);
                background-image: -o-linear-gradient(top, #F7F5F6, #DDDDDD);
                background-image: linear-gradient(to bottom, #F7F5F6, #DDDDDD);
                filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#F7F5F6, endColorstr=#DDDDDD);
                white-space: normal;
                font-size: 1vw;
            }
            
            button:hover{
                border:1px solid #ADADAD;
                background-color: #E0E0E0;
                background-image: -webkit-gradient(linear, left top, left bottom, from(#E0E0E0), to(#BDBBBC));
                background-image: -webkit-linear-gradient(top, #E0E0E0, #BDBBBC);
                background-image: -moz-linear-gradient(top, #E0E0E0, #BDBBBC);
                background-image: -ms-linear-gradient(top, #E0E0E0, #BDBBBC);
                background-image: -o-linear-gradient(top, #E0E0E0, #BDBBBC);
                background-image: linear-gradient(to bottom, #E0E0E0, #BDBBBC);
                filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#E0E0E0, endColorstr=#BDBBBC);
            }            
            
            button:active{
                border:1px solid #ADADAD;
                background-color: #E0E0E0;
                background-image: -webkit-gradient(linear, left top, left bottom, from(#BDBBBC), to(#E0E0E0));
                background-image: -webkit-linear-gradient(top, #BDBBBC, #E0E0E0);
                background-image: -moz-linear-gradient(top, #BDBBBC, #E0E0E0);
                background-image: -ms-linear-gradient(top, #BDBBBC, #E0E0E0);
                background-image: -o-linear-gradient(top, #BDBBBC, #E0E0E0);
                background-image: linear-gradient(to bottom, #BDBBBC, #E0E0E0);
                filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#BDBBBC, endColorstr=#E0E0E0);
            }
            
            div {
                text-shadow: 0px 2px 2px rgba(255,255,255,1);
                color: #202020;
            }
            
            textarea {
                font-family: mono, courier, fixed, serif;
                position: relative;
                float: left;
                border: 0.1px solid #CCCCCC;
                padding: 1.5vw;
                margin: 1vw;
                font-size: 1.5vh;
                -webkit-box-shadow: #CCCCCC 0px 2px 2px ;
                -moz-box-shadow: #CCCCCC 0px 2px 2px ;
                box-shadow: #CCCCCC 0px 2px 2px ;
                -webkit-border-radius: 5px;
                -moz-border-radius: 5px;
                border-radius: 5px;
                text-shadow: 0px 2px 2px rgba(255,255,255,1);
                color: #4A4A4A;
                background-color: #F7F5F6;
                background-image: -webkit-gradient(linear, left top, left bottom, from(#DDDDDD), to(#F7F5F6));
                background-image: -webkit-linear-gradient(top, #DDDDDD, #F7F5F6);
                background-image: -moz-linear-gradient(top, #DDDDDD, #F7F5F6);
                background-image: -ms-linear-gradient(top, #DDDDDD, #F7F5F6);
                background-image: -o-linear-gradient(top, #DDDDDD, #F7F5F6);
                background-image: linear-gradient(to bottom, #DDDDDD, #F7F5F6);
                filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#DDDDDD, endColorstr=#F7F5F6);
            }
            
            
            div.block {
                font-family: verdana, arial, sansserif;
                position: relative;
                float: left;
                height: 100vh;
                white-space: normal;
                vertical-align: top;
                text-align: middle;
            }
            
            div.help {
                position: absolute;
                left: 10vw;
                top: 10vh;
                width: 80vw;
                height: 70vh;
                display:none;
                border: 0.1px solid #CCCCCC;
                padding: 1.5vw;
                margin: 1vw;
                font-size: 2vh;
                -webkit-box-shadow: #CCCCCC 0px 2px 2px ;
                -moz-box-shadow: #CCCCCC 0px 2px 2px ;
                box-shadow: #CCCCCC 0px 2px 2px ;
                -webkit-border-radius: 5px;
                -moz-border-radius: 5px;
                border-radius: 5px;
                text-shadow: 0px 2px 2px rgba(255,255,255,1);
                color: #4A4A4A;
                background-color: #F7F5F6;
                background-image: -webkit-gradient(linear, left top, left bottom, from(#EEEEEE), to(#FEFEFE));
                background-image: -webkit-linear-gradient(top, #EEEEEE, #FEFEFE);
                background-image: -moz-linear-gradient(top, #EEEEEE, #FEFEFE);
                background-image: -ms-linear-gradient(top, #EEEEEE, #FEFEFE);
                background-image: -o-linear-gradient(top, #EEEEEE, #FEFEFE);
                background-image: linear-gradient(to bottom, #EEEEEE, #FEFEFE);
                filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#EEEEEE, endColorstr=#FEFEFE);
            }
            
            </style>
        
        <script type="text/javascript">
            <!--
            

            //__________________________________________________________________________________
            // initialise character dictionary
            //
            function Dict74()
            {
                this.dict = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789.,:;+*-/()'\"";
            }
            
            
            //__________________________________________________________________________________
            // create a number array that represents a word, base74
            //
            Dict74.prototype.code = function(word)
            {
                result = [];
                for (var i=0; i<word.length; i++)
                    result.push( this.dict.indexOf( word[i] ) );
                return result;
            }
            
            
            //__________________________________________________________________________________
            // create a character word from a number array, base74
            //
            Dict74.prototype.decode = function(array)
            {
                result = "";
                for (var i=0; i<array.length; i++)
                    result += this.dict[array[i]];
                return result;
            }
            
            
            //__________________________________________________________________________________
            // output a number array to string, nicely aligned
            //
            function toString(array)
            {
                result = "";
                for (var i=0; i<array.length; i++)
                    if (array[i] < 0)
                        result += "  .";
                    else if (array[i] < 10)
                        result += "  " + array[i].toString();
                    else
                        result += " " + array[i].toString();
                
                return result;
            }
            
            
            //__________________________________________________________________________________
            // global dictionary instance
            //
            var _dict74 = new Dict74();
            
            
            //__________________________________________________________________________________
            // expand a word to have the required number of letters by repeating it
            //
            function expand(word, letters)
            {
                result = "";
                for (i=0, w=0; i<letters; i++, w++) {
                    if (w >= word.length)
                        w = 0;
                    result += word[w];
                }
                return result;
            }
            
            
            //__________________________________________________________________________________
            // combines two words. The character i of the result is computed the following way:
            // the weighted sum of characters of the first word is computed by multiplying
            // each character j of the first word with the distance i-j to the current character
            // this weighted sum is added to the character i of the second word,
            // then modulo 74 is taken (we only use 74 different characters)
            // example: first word: 0,1,2,3,4; second word; 4,3,2,1,0; character to calculate: 1.
            // first word:   0   1   2   3   4
            // weights:      1   0   1   2   3
            // char*weights: 0   0   2   6  12
            // sum:          .  20   .   .   .
            // second word:  4   3   2   1   0
            // result:       .  23   .   .   .
            //
            function combine(first, second, n)
            {
                result = [];
                for (var i=0; i<n; i++) {
                    char = second[i];
                    for (var j=0; j<n; j++) {
                        char += first[j] * Math.abs(i-j);
                    }
                    char = Math.abs(char) % 74;
                    result.push(char);
                }
                return result;
            }
            
            
            //__________________________________________________________________________________
            // complete calculation
            //
            function calculate(n)
            {
                // read from source field
                url = document.getElementById("url").value.trim();
                url = url.replace(/ /g,'');
                words = document.getElementById("phrase").value.trim().split(' ');
                words = [url].concat(words).concat("A");   // adding a last step of zeros ('A') for an additional weighted sum 
                
                // expand entries
                for (var i=0; i<words.length; i++)
                    words[i] = expand(words[i], n);
                
                // write into target field
                string = "";
                combineStr = words[0];
                combineArr = _dict74.code(combineStr);
                for (var w=1; w<words.length; w++) {
                    wordStr = words[w];
                    wordArr = _dict74.code(wordStr);
                    string += "multiply:   " + combineStr + "   " + toString(combineArr) + "\n";
                    string += "add:        " + wordStr + "   " + toString(wordArr) + "\n";
                    
                    combineArr = combine(combineArr, wordArr, n);
                    combineStr = _dict74.decode(combineArr);
                    string += "modulo:     " + combineStr + "   " + toString(combineArr) + "\n";
                    string += "\n";
                }
                document.getElementById("progress").value = string;
                document.getElementById("password").value = combineStr;
            }
            
            
            //__________________________________________________________________________________
            // clear the contents of one or all text fields
            //
            function clearData(id='all')
            {
                if (id==='all') {
                    clearData("url");
                    clearData("phrase");
                    clearData("progress");
                    clearData("password");
                }
                else
                    document.getElementById(id).value = "";
            }
            
            //-->
        </script>

    </head>
    <body>
        <div class="block">
            <textarea id="url" wrap="hard" rows="1" style="width:25vw; height:5vh; font-size:1.0vw;" onfocus="clearData('url')">Replace this text with the website name</textarea><br/>
            <textarea id="phrase" wrap="hard" rows= "200" style="width:25vw; height:70vh; font-size:1.0vw;" onfocus="clearData('phrase')">Replace this text with a passphrase of five or more words. Be sure to use words that are easy to remember. Pressing one of the Password Creation buttons will create a unique password in the top right field. Copy+Paste it from there. Pressing the Clear-Data button or Ctrl+F5 clears all data.</textarea>
        </div>
        <div class="block">
            <button onClick="calculate(8)">8 Character Password</button><br/>
            <button onClick="calculate(10)">10 Character Password</button><br/>
            <button onClick="calculate(15)">15 Character Password</button><br/>
            <button onClick="calculate(23)">23 Character Password</button><br/>
            <button onClick="clearData()">Clear Data</button><br/>
            <button onclick="document.getElementById('help').style.display='block';" style="font-weight: bold;">Instructions / Help / Explanation</button>
        </div>
        <div class="block">
            <textarea id="password" wrap="hard" rows="1" style="width:49vw; height:5vh; font-size:2.1vw;">Your Password</textarea><br/>
            <textarea id="progress" wrap="hard" rows="200" style="width:49vw; height:70vh; font-size:0.7vw;">Calculation Details</textarea>
        </div>
        <div id="help" class="help">
            <h2>You should not re-use passwords.</h2>
            <h3>If an attacker gets hold of your password, they can login to many other sites using your account. This tool creates a unique password for each of your websites. All it needs is the website's name and a passphrase of 5 or more words.</h3>
            
            <h3>Instructions</h3>
            &#9654; Type the website into the top left field.<br/>
            &#9654; Type your passphrase into the field below. Use the same passphrase for all your accounts. Use something that's easy to remember, but contains five words or more. Remember it. Never write it down anywhere.<br/>
            &#9654; Click one of the buttons to create a password.<br/>
            &#9654; Some calculation details are displayed in the bottom right field.<br/>
            &#9654; Your password will be displayed in the top right corner. Copy and paste it into the website.<br/>
            &#9654; Remove the data from your browser by pressing Ctrl+F5 or the button Clear Data to prevent a bystander from reading your passphrase.<br/>
            
            <h3>How does this work</h3>
            Each generated password is unique for the website and the passphrase. Technically, the passphrase is split up into words, then the website name is combined with these words in a series of multiply, add and modulo operations. Every single character in the passphrase influences all characters in the resulting password. This make it impossible to retain the passphrase from the website and the password. Even if somebody gets hold of this password, all your other passwords are safe.<br/><br/>
            All mathematical operations are executed in your browser. Nothing is stored on the web. The source code is entirely inside this page, nothing is loaded from external sources. To check you may right-click and select "show page source".<br/><br/>
            <button onclick="document.getElementById('help').style.display='none';">OK</button>
        </div>
    </body>

</html>



